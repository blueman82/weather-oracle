(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8048:function(e,t,a){Promise.resolve().then(a.bind(a,1954))},1954:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var s=a(7379),r=a(5350),l=a(6504);function n(e){let{onLocationSelect:t,placeholder:a="Search for a city...",initialValue:n=""}=e,[i,o]=(0,r.useState)(n),[c,d]=(0,r.useState)(!1),[x,m]=(0,r.useState)(-1),h=(0,r.useRef)(null),u=(0,r.useRef)(null),[p,f]=(0,r.useState)(i);(0,r.useEffect)(()=>{let e=setTimeout(()=>{f(i)},300);return()=>clearTimeout(e)},[i]);let{data:b,isLoading:g,isFetching:j}=(0,l.a)({queryKey:["geocode",p],queryFn:async()=>{if(!p||p.length<2)return[];let e=new URLSearchParams({q:p,count:"5"}),t=await fetch("/api/geocode?".concat(e)),a=await t.json();return a.success&&a.data?a.data.results:[]},enabled:p.length>=2,staleTime:6e4}),k=null!=b?b:[],w=(0,r.useCallback)(e=>{if(!c){"ArrowDown"===e.key&&k.length>0&&(d(!0),m(0),e.preventDefault());return}switch(e.key){case"ArrowDown":e.preventDefault(),m(e=>e<k.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),m(e=>e>0?e-1:0);break;case"Enter":e.preventDefault(),x>=0&&x<k.length&&v(k[x]);break;case"Escape":d(!1),m(-1)}},[c,k,x]),v=(0,r.useCallback)(e=>{o(e.name),d(!1),m(-1),t(e)},[t]);return(0,r.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&h.current&&!h.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{i.length>=2&&k.length>0&&d(!0)},[i,k]),(0,s.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{ref:h,type:"text",value:i,onChange:e=>o(e.target.value),onKeyDown:w,onFocus:()=>k.length>0&&d(!0),placeholder:a,className:"w-full px-4 py-3 pl-10 text-slate-900 dark:text-white bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",role:"combobox","aria-expanded":c,"aria-autocomplete":"list","aria-controls":"location-listbox","aria-activedescendant":x>=0?"location-option-".concat(x):void 0}),(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(g||j)&&(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,s.jsxs)("svg",{className:"w-5 h-5 text-primary-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),c&&k.length>0&&(0,s.jsx)("div",{ref:u,id:"location-listbox",role:"listbox",className:"absolute z-50 w-full mt-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg overflow-hidden",children:k.map((e,t)=>(0,s.jsx)("button",{id:"location-option-".concat(t),role:"option","aria-selected":t===x,onClick:()=>v(e),onMouseEnter:()=>m(t),className:"w-full px-4 py-3 text-left transition-colors ".concat(t===x?"bg-primary-50 dark:bg-primary-900/30":"hover:bg-slate-50 dark:hover:bg-slate-700/50"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-900 dark:text-white",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[e.region?"".concat(e.region,", "):"",e.country]})]}),(0,s.jsxs)("span",{className:"text-xs text-slate-400 dark:text-slate-500 font-mono",children:[e.coordinates.latitude.toFixed(2),","," ",e.coordinates.longitude.toFixed(2)]})]})},"".concat(e.coordinates.latitude,"-").concat(e.coordinates.longitude)))}),c&&i.length>=2&&!g&&!j&&0===k.length&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg p-4",children:(0,s.jsxs)("p",{className:"text-sm text-slate-500 dark:text-slate-400 text-center",children:["No locations found for “",i,"”"]})})]})}a(2563);let i={high:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-800 dark:text-green-300",border:"border-green-300 dark:border-green-700",ring:"ring-green-500",icon:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),label:"High"},medium:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-800 dark:text-amber-300",border:"border-amber-300 dark:border-amber-700",ring:"ring-amber-500",icon:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),label:"Medium"},low:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-800 dark:text-red-300",border:"border-red-300 dark:border-red-700",ring:"ring-red-500",icon:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),label:"Low"}},o={sm:"px-2 py-0.5 text-xs gap-1",md:"px-2.5 py-1 text-sm gap-1.5",lg:"px-3 py-1.5 text-base gap-2"};function c(e){let{level:t,score:a,showScore:r=!1,size:l="md",animated:n=!1}=e,c=i[t],d=Math.round(100*a);return(0,s.jsxs)("span",{className:"inline-flex items-center font-medium rounded-full border ".concat(c.bg," ").concat(c.text," ").concat(c.border," ").concat(o[l]," ").concat(n?"confidence-pulse":""),title:"".concat(c.label," confidence: ").concat(d,"%"),children:[c.icon,(0,s.jsxs)("span",{children:[c.label,r&&(0,s.jsxs)("span",{className:"ml-1 opacity-75",children:["(",d,"%)"]})]})]})}function d(e){let{score:t,size:a="md",showLabel:r=!0}=e,l=Math.round(100*t),n=t>=.7?"high":t>=.4?"medium":"low",o=i[n];return(0,s.jsxs)("div",{className:"w-full",children:[r&&(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsxs)("span",{className:"text-xs font-medium ".concat(o.text),children:[o.label," Confidence"]}),(0,s.jsxs)("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[l,"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden ".concat({sm:"h-1.5",md:"h-2",lg:"h-3"}[a]),children:(0,s.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ease-out ".concat("high"===n?"bg-green-500":"medium"===n?"bg-amber-500":"bg-red-500"),style:{width:"".concat(l,"%")}})})]})}function x(e){return 0===e?{icon:"sunny",description:"Clear sky"}:e>=1&&e<=2?{icon:"partly-cloudy",description:"Partly cloudy"}:3===e?{icon:"cloudy",description:"Overcast"}:e>=45&&e<=48?{icon:"fog",description:"Foggy"}:e>=51&&e<=57?{icon:"drizzle",description:"Drizzle"}:e>=61&&e<=65?{icon:"rain",description:"Rain"}:e>=66&&e<=67?{icon:"rain",description:"Freezing rain"}:e>=80&&e<=82?{icon:"rain",description:"Rain showers"}:e>=71&&e<=77?{icon:"snow",description:"Snow"}:e>=85&&e<=86?{icon:"snow",description:"Snow showers"}:e>=95&&e<=99?{icon:"thunderstorm",description:"Thunderstorm"}:{icon:"cloudy",description:"Mixed conditions"}}let m={sm:"w-6 h-6",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"};function h(e){let{code:t,size:a="md",className:r=""}=e,{icon:l,description:n}=x(t),i="".concat(m[a]," ").concat(r);switch(l){case"sunny":return(0,s.jsxs)("svg",{className:"".concat(i," text-yellow-500"),viewBox:"0 0 24 24",fill:"currentColor","aria-label":n,children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"5"}),(0,s.jsx)("path",{d:"M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})]});case"partly-cloudy":return(0,s.jsxs)("svg",{className:"".concat(i," text-slate-400"),viewBox:"0 0 24 24",fill:"none","aria-label":n,children:[(0,s.jsx)("circle",{cx:"10",cy:"8",r:"3",fill:"#fbbf24"}),(0,s.jsx)("path",{d:"M10 2v1.5M10 11.5V13M3.64 4.64l1.06 1.06M15.3 4.64l-1.06 1.06M2.5 8H4M16 8h1.5",stroke:"#fbbf24",strokeWidth:"1.5",strokeLinecap:"round"}),(0,s.jsx)("path",{d:"M8 18h8a4 4 0 000-8h-.5a5.5 5.5 0 00-10.67 1.4A3.5 3.5 0 008 18z",fill:"currentColor"})]});case"cloudy":return(0,s.jsx)("svg",{className:"".concat(i," text-slate-400"),viewBox:"0 0 24 24",fill:"currentColor","aria-label":n,children:(0,s.jsx)("path",{d:"M6.5 19h11a4.5 4.5 0 001.13-8.86A6.5 6.5 0 005.07 12.1 4 4 0 006.5 19z"})});case"fog":return(0,s.jsx)("svg",{className:"".concat(i," text-slate-400"),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round","aria-label":n,children:(0,s.jsx)("path",{d:"M4 14h16M4 10h16M4 18h16"})});case"drizzle":return(0,s.jsxs)("svg",{className:"".concat(i," text-blue-400"),viewBox:"0 0 24 24",fill:"none","aria-label":n,children:[(0,s.jsx)("path",{d:"M6.5 12h11a4.5 4.5 0 001.13-8.86A6.5 6.5 0 005.07 5.1 4 4 0 006.5 12z",fill:"currentColor",className:"text-slate-400"}),(0,s.jsx)("path",{d:"M8 15v2M12 16v2M16 15v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]});case"rain":return(0,s.jsxs)("svg",{className:"".concat(i," text-blue-500"),viewBox:"0 0 24 24",fill:"none","aria-label":n,children:[(0,s.jsx)("path",{d:"M6.5 11h11a4.5 4.5 0 001.13-8.86A6.5 6.5 0 005.07 4.1 4 4 0 006.5 11z",fill:"currentColor",className:"text-slate-400"}),(0,s.jsx)("path",{d:"M7 14v3M11 13v4M15 14v3M19 13v4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]});case"snow":return(0,s.jsxs)("svg",{className:"".concat(i," text-blue-200"),viewBox:"0 0 24 24",fill:"none","aria-label":n,children:[(0,s.jsx)("path",{d:"M6.5 10h11a4.5 4.5 0 001.13-8.86A6.5 6.5 0 005.07 3.1 4 4 0 006.5 10z",fill:"currentColor",className:"text-slate-400"}),(0,s.jsx)("circle",{cx:"8",cy:"15",r:"1.5",fill:"currentColor"}),(0,s.jsx)("circle",{cx:"12",cy:"17",r:"1.5",fill:"currentColor"}),(0,s.jsx)("circle",{cx:"16",cy:"14",r:"1.5",fill:"currentColor"}),(0,s.jsx)("circle",{cx:"10",cy:"20",r:"1.5",fill:"currentColor"}),(0,s.jsx)("circle",{cx:"14",cy:"20",r:"1.5",fill:"currentColor"})]});case"thunderstorm":return(0,s.jsxs)("svg",{className:"".concat(i," text-slate-500"),viewBox:"0 0 24 24",fill:"none","aria-label":n,children:[(0,s.jsx)("path",{d:"M6.5 11h11a4.5 4.5 0 001.13-8.86A6.5 6.5 0 005.07 4.1 4 4 0 006.5 11z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M13 11l-3 6h4l-2 5",stroke:"#fbbf24",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}}function u(e){return"".concat(Math.round(e),"\xb0")}function p(e){let{daily:t}=e,{day:a,date:r}=function(e){let t=new Date(e),a=new Date,s=new Date(a);s.setDate(s.getDate()+1);let r=t.toDateString()===a.toDateString(),l=t.toDateString()===s.toDateString();return{day:r?"Today":l?"Tomorrow":t.toLocaleDateString("en-US",{weekday:"short"}),date:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}(t.date.toString());return(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-slate-100 dark:border-slate-700 last:border-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 min-w-[120px]",children:[(0,s.jsx)(h,{code:t.forecast.weatherCode,size:"md"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-900 dark:text-white",children:a}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:r})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsxs)("div",{className:"text-right min-w-[80px]",children:[(0,s.jsx)("span",{className:"font-semibold text-slate-900 dark:text-white",children:u(t.forecast.temperature.max)}),(0,s.jsx)("span",{className:"text-slate-400 mx-1",children:"/"}),(0,s.jsx)("span",{className:"text-slate-500 dark:text-slate-400",children:u(t.forecast.temperature.min)})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 min-w-[60px]",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.5 17a4.5 4.5 0 01-1.44-8.765 4.5 4.5 0 018.302-3.046 3.5 3.5 0 014.504 4.272A4 4 0 0115 17H5.5zm3.75-2.75a.75.75 0 001.5 0V9.66l1.95 2.1a.75.75 0 101.1-1.02l-3.25-3.5a.75.75 0 00-1.1 0l-3.25 3.5a.75.75 0 101.1 1.02l1.95-2.1v4.59z",clipRule:"evenodd"})}),(0,s.jsxs)("span",{className:"text-sm text-slate-600 dark:text-slate-300",children:[Math.round(t.forecast.precipitation.probability),"%"]})]}),(0,s.jsx)("div",{className:"hidden sm:block",children:(0,s.jsx)(c,{level:t.confidence.level,score:t.confidence.score,size:"sm"})})]})]})}function f(e){let{data:t}=e,{location:a,forecast:r,confidence:l,narrative:n}=t,i=r.daily[0];return(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 text-white p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:a.name}),(0,s.jsxs)("p",{className:"text-primary-100",children:[a.region?"".concat(a.region,", "):"",a.country]})]}),(0,s.jsx)(c,{level:l.level,score:l.score,showScore:!0,size:"md"})]}),i&&(0,s.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(h,{code:i.forecast.weatherCode,size:"xl",className:"text-white"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-5xl font-light",children:u(i.forecast.temperature.max)}),(0,s.jsx)("p",{className:"text-primary-100",children:x(i.forecast.weatherCode).description})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-primary-100",children:"Feels like"}),(0,s.jsx)("p",{className:"text-2xl",children:u(i.forecast.temperature.min)})]})]})]}),(0,s.jsxs)("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-2",children:n.headline}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-300",children:n.body}),n.alerts.length>0&&(0,s.jsx)("div",{className:"mt-4 space-y-2",children:n.alerts.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-2 text-amber-700 dark:text-amber-400",children:[(0,s.jsx)("svg",{className:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-sm",children:e})]},t))}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(d,{score:l.score})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-4",children:"7-Day Forecast"}),(0,s.jsx)("div",{children:r.daily.map((e,t)=>(0,s.jsx)(p,{daily:e},t))})]}),n.modelNotes.length>0&&(0,s.jsx)("div",{className:"px-6 pb-6",children:(0,s.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-700/50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Model Notes"}),(0,s.jsx)("ul",{className:"space-y-1",children:n.modelNotes.map((e,t)=>(0,s.jsx)("li",{className:"text-sm text-slate-600 dark:text-slate-400",children:e},t))})]})})]})}let b={ecmwf:"#2563eb",gfs:"#dc2626",icon:"#16a34a",meteofrance:"#9333ea",ukmo:"#ea580c",jma:"#0891b2",gem:"#be123c"};function g(e){return"".concat(Math.round(e),"\xb0")}function j(e){let{data:t,selectedDate:a}=e,{models:l,outliers:n}=t,i=(0,r.useMemo)(()=>{let e=l.find(e=>"success"===e.status);return e?e.forecast.daily.map(e=>e.date):[]},[l]),o=null!=a?a:i[0],c=(0,r.useMemo)(()=>{if(!o)return new Set;let e=new Date(o).toISOString().split("T")[0];return new Set(n.filter(t=>t.timestamp.toString().split("T")[0]===e).map(e=>e.model))},[o,n]),d=e=>{let t=new Date(e),a=new Date,s=new Date(a);return(s.setDate(s.getDate()+1),t.toDateString()===a.toDateString())?"Today":t.toDateString()===s.toDateString()?"Tomorrow":t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},x=e=>"success"===e.status&&o?e.forecast.daily.find(e=>new Date(e.date).toDateString()===new Date(o).toDateString()):null;return(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Model Comparison"}),(0,s.jsxs)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["Compare forecasts from ",l.filter(e=>"success"===e.status).length," weather models"]}),i.length>0&&(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:i.slice(0,7).map(e=>(0,s.jsx)("button",{onClick:()=>{},className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat(e===o?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"bg-slate-100 text-slate-600 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"),children:d(e)},e))})]}),(0,s.jsx)("div",{className:"overflow-x-auto custom-scrollbar",children:(0,s.jsxs)("table",{className:"w-full min-w-[600px]",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-slate-50 dark:bg-slate-700/50",children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Model"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Conditions"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"High / Low"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Precipitation"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Wind (km/h)"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Status"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:l.map(e=>{var t,a;let r=x(e),l=c.has(e.model);return(0,s.jsxs)("tr",{className:"".concat(l?"bg-amber-50/50 dark:bg-amber-900/10":"hover:bg-slate-50 dark:hover:bg-slate-700/30"," transition-colors"),children:[(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:b[e.model]}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-900 dark:text-white",children:e.info.displayName}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[e.info.resolution," resolution"]})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:r?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(h,{code:r.weatherCode,size:"md"})}):(0,s.jsx)("span",{className:"text-slate-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:r?(0,s.jsxs)("span",{className:"text-slate-900 dark:text-white",children:[(0,s.jsx)("span",{className:"font-semibold",children:g(r.temperatureMax)}),(0,s.jsx)("span",{className:"text-slate-400 mx-1",children:"/"}),(0,s.jsx)("span",{className:"text-slate-500",children:g(r.temperatureMin)})]}):(0,s.jsx)("span",{className:"text-slate-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:r?(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:(t=r.precipitationTotal)<.1?"-":t<1?"<1mm":"".concat(Math.round(t),"mm")}),r.precipitationProbability>0&&(0,s.jsxs)("span",{className:"text-xs text-slate-500 ml-1",children:["(",Math.round(r.precipitationProbability),"%)"]})]}):(0,s.jsx)("span",{className:"text-slate-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:r?(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:(a=r.windMaxSpeed,"".concat(Math.round(3.6*a)))}):(0,s.jsx)("span",{className:"text-slate-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:"success"===e.status?l?(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300",children:"Outlier"}):(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:"OK"}):(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",title:e.error,children:"Failed"})})]},e.model)})})]})}),(0,s.jsx)("div",{className:"p-6 bg-slate-50 dark:bg-slate-700/30",children:(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-primary-600",children:t.summary.successfulModels}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Models Active"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:c.size}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Outliers"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-red-600",children:t.summary.failedModels}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Unavailable"})]})]})})]})}var k=a(9594),w=a(4619),v=a(699),N=a(525),y=a(7405),M=a(9584),C=a(6191),S=a(3844),D=a(1747),z=a(5705);let L={ecmwf:"#2563eb",gfs:"#dc2626",icon:"#16a34a",meteofrance:"#9333ea",ukmo:"#ea580c",jma:"#0891b2",gem:"#be123c"},F={ecmwf:"ECMWF",gfs:"GFS",icon:"ICON",meteofrance:"ARPEGE",ukmo:"UK Met",jma:"JMA",gem:"GEM"};function E(e){let{data:t,metric:a="temperature"}=e,{models:l}=t,n=(0,r.useMemo)(()=>{let e=l.filter(e=>"success"===e.status);if(0===e.length)return[];let t=new Set;return e.forEach(e=>{e.forecast.daily.forEach(e=>{t.add(e.date)})}),Array.from(t).sort().map(t=>{let s=new Date(t),r={date:t,displayDate:s.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})};return e.forEach(e=>{let s=e.forecast.daily.find(e=>e.date===t);if(s)switch(a){case"temperature":r["".concat(e.model,"_high")]=Math.round(s.temperatureMax),r["".concat(e.model,"_low")]=Math.round(s.temperatureMin);break;case"precipitation":r[e.model]=Math.round(10*s.precipitationTotal)/10;break;case"wind":r[e.model]=Math.round(3.6*s.windMaxSpeed)}}),r})},[l,a]),i=l.filter(e=>"success"===e.status);if(0===n.length)return(0,s.jsx)("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg p-6",children:(0,s.jsx)("p",{className:"text-slate-500 dark:text-slate-400 text-center",children:"No chart data available"})});let o=()=>{switch(a){case"temperature":return"Temperature (\xb0C)";case"precipitation":return"Precipitation (mm)";case"wind":return"Wind Speed (km/h)"}};return(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:["Model Comparison - ",a.charAt(0).toUpperCase()+a.slice(1)]}),(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Spaghetti plot showing model spread"})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"h-[400px]",children:(0,s.jsx)(k.h,{width:"100%",height:"100%",children:"temperature"===a?(0,s.jsxs)(w.c,{data:n,children:[(0,s.jsx)(v.q,{strokeDasharray:"3 3",stroke:"#e2e8f0",className:"dark:stroke-slate-700"}),(0,s.jsx)(N.K,{dataKey:"displayDate",tick:{fontSize:12},tickMargin:8,stroke:"#94a3b8"}),(0,s.jsx)(y.B,{domain:(()=>{if("temperature"===a){let e=1/0,t=-1/0;return n.forEach(a=>{i.forEach(s=>{let r=a["".concat(s.model,"_high")],l=a["".concat(s.model,"_low")];void 0!==r&&(t=Math.max(t,r)),void 0!==l&&(e=Math.min(e,l))})}),[Math.floor(e-2),Math.ceil(t+2)]}return["auto","auto"]})(),tick:{fontSize:12},tickMargin:8,stroke:"#94a3b8",label:{value:o(),angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"#94a3b8"}}}),(0,s.jsx)(M.u,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:"8px",border:"1px solid #e2e8f0",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:(e,t)=>{let[a,s]=t.split("_");return["".concat(e,"\xb0C"),"".concat(F[a]," ").concat("high"===s?"High":"Low")]}}),(0,s.jsx)(C.D,{formatter:e=>{let[t]=e.split("_");return F[t]},wrapperStyle:{paddingTop:"20px"}}),i.map(e=>(0,s.jsx)(S.uN,{type:"monotone",dataKey:"".concat(e.model,"_high"),stroke:L[e.model],fill:L[e.model],fillOpacity:.1,strokeWidth:2,dot:{r:3},activeDot:{r:5}},e.model)),i.map(e=>(0,s.jsx)(D.x1,{type:"monotone",dataKey:"".concat(e.model,"_low"),stroke:L[e.model],strokeWidth:2,strokeDasharray:"5 5",dot:{r:3},activeDot:{r:5}},"".concat(e.model,"_low")))]}):(0,s.jsxs)(z.w,{data:n,children:[(0,s.jsx)(v.q,{strokeDasharray:"3 3",stroke:"#e2e8f0",className:"dark:stroke-slate-700"}),(0,s.jsx)(N.K,{dataKey:"displayDate",tick:{fontSize:12},tickMargin:8,stroke:"#94a3b8"}),(0,s.jsx)(y.B,{tick:{fontSize:12},tickMargin:8,stroke:"#94a3b8",label:{value:o(),angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"#94a3b8"}}}),(0,s.jsx)(M.u,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:"8px",border:"1px solid #e2e8f0",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:(e,t)=>{let s="precipitation"===a?"mm":"km/h";return["".concat(e," ").concat(s),F[t]]}}),(0,s.jsx)(C.D,{formatter:e=>F[e],wrapperStyle:{paddingTop:"20px"}}),i.map(e=>(0,s.jsx)(D.x1,{type:"monotone",dataKey:e.model,stroke:L[e.model],strokeWidth:2,dot:{r:3},activeDot:{r:5}},e.model))]})})}),(0,s.jsx)("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700/30 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"temperature"===a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("strong",{children:"Solid lines:"})," High temperatures,"," ",(0,s.jsx)("strong",{children:"Dashed lines:"})," Low temperatures. The spread between models indicates forecast uncertainty."]}):"precipitation"===a?(0,s.jsx)(s.Fragment,{children:"Shows total daily precipitation from each model. Wider spread indicates more uncertainty about rain/snow amounts."}):(0,s.jsx)(s.Fragment,{children:"Maximum wind speeds (in km/h) predicted by each model. Converging lines suggest higher confidence."})})})]})]})}function T(){let[e,t]=(0,r.useState)(null),[a,i]=(0,r.useState)("forecast"),[o,c]=(0,r.useState)("temperature"),{data:d,isLoading:x,error:m}=(0,l.a)({queryKey:["forecast",null==e?void 0:e.coordinates],queryFn:async()=>{if(!e)return null;let t=new URLSearchParams({lat:e.coordinates.latitude.toString(),lon:e.coordinates.longitude.toString(),days:"7"}),a=await fetch("/api/forecast?".concat(t)),s=await a.json();if(!s.success||!s.data){var r,l;throw Error(null!==(l=null===(r=s.error)||void 0===r?void 0:r.message)&&void 0!==l?l:"Failed to fetch forecast")}return s.data},enabled:!!e,staleTime:3e5}),{data:h,isLoading:u,error:p}=(0,l.a)({queryKey:["compare",null==e?void 0:e.coordinates],queryFn:async()=>{if(!e)return null;let t=new URLSearchParams({lat:e.coordinates.latitude.toString(),lon:e.coordinates.longitude.toString(),days:"7"}),a=await fetch("/api/compare?".concat(t)),s=await a.json();if(!s.success||!s.data){var r,l;throw Error(null!==(l=null===(r=s.error)||void 0===r?void 0:r.message)&&void 0!==l?l:"Failed to fetch comparison")}return s.data},enabled:!!e&&"forecast"!==a,staleTime:3e5}),b=(0,r.useCallback)(e=>{t(e)},[]),g=x||"forecast"!==a&&u,k=null!=m?m:"forecast"!==a?p:null;return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("section",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-2",children:"Multi-Model Weather Forecasts"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mb-6 max-w-2xl mx-auto",children:"Get aggregated forecasts from 7 weather models with confidence indicators and narrative summaries. Understand not just what the weather will be, but how certain we are about it."}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(n,{onLocationSelect:b,placeholder:"Search for a city or location..."})})]}),e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"inline-flex bg-white dark:bg-slate-800 rounded-lg p-1 shadow-sm",children:[(0,s.jsx)("button",{onClick:()=>i("forecast"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("forecast"===a?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"),children:"Forecast"}),(0,s.jsx)("button",{onClick:()=>i("compare"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("compare"===a?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"),children:"Model Comparison"}),(0,s.jsx)("button",{onClick:()=>i("chart"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("chart"===a?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"),children:"Charts"})]})}),g&&(0,s.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,s.jsxs)("svg",{className:"w-12 h-12 text-primary-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Fetching forecasts from multiple models..."})]})}),k&&!g&&(0,s.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center",children:[(0,s.jsx)("svg",{className:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-300 mb-2",children:"Failed to load forecast"}),(0,s.jsx)("p",{className:"text-red-600 dark:text-red-400",children:k instanceof Error?k.message:"An error occurred"})]}),!g&&!k&&(0,s.jsxs)(s.Fragment,{children:["forecast"===a&&d&&(0,s.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,s.jsx)(f,{data:d})}),"compare"===a&&h&&(0,s.jsx)(j,{data:h}),"chart"===a&&h&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"inline-flex bg-white dark:bg-slate-800 rounded-lg p-1 shadow-sm",children:[(0,s.jsx)("button",{onClick:()=>c("temperature"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors ".concat("temperature"===o?"bg-slate-200 text-slate-900 dark:bg-slate-700 dark:text-white":"text-slate-600 hover:text-slate-900 dark:text-slate-400"),children:"Temperature"}),(0,s.jsx)("button",{onClick:()=>c("precipitation"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors ".concat("precipitation"===o?"bg-slate-200 text-slate-900 dark:bg-slate-700 dark:text-white":"text-slate-600 hover:text-slate-900 dark:text-slate-400"),children:"Precipitation"}),(0,s.jsx)("button",{onClick:()=>c("wind"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors ".concat("wind"===o?"bg-slate-200 text-slate-900 dark:bg-slate-700 dark:text-white":"text-slate-600 hover:text-slate-900 dark:text-slate-400"),children:"Wind"})]})}),(0,s.jsx)(E,{data:h,metric:o})]})]})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsxs)("svg",{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,s.jsx)("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"Enter a location to get started"}),(0,s.jsx)("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto",children:"Search for a city or location above to see multi-model weather forecasts with confidence indicators."}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-3",children:"Try these popular locations:"}),(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:[{name:"New York",lat:40.7128,lon:-74.006},{name:"London",lat:51.5074,lon:-.1278},{name:"Tokyo",lat:35.6762,lon:139.6503},{name:"Sydney",lat:-33.8688,lon:151.2093}].map(e=>(0,s.jsx)("button",{onClick:()=>t({name:e.name,coordinates:{latitude:e.lat,longitude:e.lon},country:"",countryCode:"",timezone:"UTC"}),className:"px-4 py-2 bg-white dark:bg-slate-800 rounded-full text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors shadow-sm",children:e.name},e.name))})]})]})]})}},2563:function(e,t,a){"use strict";a.d(t,{Providers:function(){return i}});var s=a(7379),r=a(2554),l=a(3398),n=a(5350);function i(e){let{children:t}=e,[a]=(0,n.useState)(()=>new r.S({defaultOptions:{queries:{staleTime:3e5,gcTime:18e5,retry:2,refetchOnWindowFocus:!1}}}));return(0,s.jsx)(l.aH,{client:a,children:t})}}},function(e){e.O(0,[675,694,646,714,744],function(){return e(e.s=8048)}),_N_E=e.O()}]);