"use strict";exports.id=683,exports.ids=[683],exports.modules={1583:(e,t,r)=>{r.d(t,{_j:()=>c});var i=r(612),n=r(9411),a=r(3977),o=r(7561),l=r(6005),s=r(5758);let d=".cache.json";class u{constructor(e={}){this.initialized=!1,this.hits=0,this.misses=0,this.cacheDir=e.cacheDir??(0,n.join)((0,i.homedir)(),".weather-oracle","cache"),this.defaultTtl=e.defaultTtl??3600,this.maxEntries=e.maxEntries??100,this.enabled=e.enabled??!0}async ensureInitialized(){if(!this.initialized&&this.enabled)try{await (0,a.mkdir)(this.cacheDir,{recursive:!0}),this.initialized=!0,await this.cleanup()}catch(e){throw s.j.initError(this.cacheDir,e instanceof Error?e:Error(String(e)))}}getFilePath(e){let t=e.replace(/[^a-zA-Z0-9_.-]/g,"_");return(0,n.join)(this.cacheDir,`${t}${d}`)}getKeyFromPath(e){return(0,n.basename)(e).replace(d,"")}async readEntry(e){let t=this.getFilePath(e);try{await (0,a.access)(t,o.constants.R_OK);let e=await (0,a.readFile)(t,"utf-8");return JSON.parse(e)}catch(r){if("ENOENT"===r.code)return null;if(r instanceof SyntaxError){try{await (0,a.unlink)(t)}catch{}return null}throw s.j.readError(e,r instanceof Error?r:Error(String(r)))}}async writeEntry(e,t){let r=this.getFilePath(e),o=(0,n.join)((0,i.tmpdir)(),`weather-oracle-${(0,l.randomUUID)()}.tmp`);try{let e=JSON.stringify(t,null,2);await (0,a.writeFile)(o,e,"utf-8"),await (0,a.rename)(o,r)}catch(t){try{await (0,a.unlink)(o)}catch{}throw s.j.writeError(e,t instanceof Error?t:Error(String(t)))}}async get(e){if(!this.enabled)return this.misses++,null;await this.ensureInitialized();let t=await this.readEntry(e);if(!t)return this.misses++,null;let r=Date.now();if(t.metadata.expiresAt<r){this.misses++;try{await (0,a.unlink)(this.getFilePath(e))}catch{}return null}return this.hits++,t.data}async set(e,t,r){if(!this.enabled)return;await this.ensureInitialized();let i=Date.now(),n=r??this.defaultTtl;await this.writeEntry(e,{data:t,metadata:{createdAt:i,expiresAt:i+1e3*n,key:e}}),await this.enforceLimit()}async enforceLimit(){try{let e=(await (0,a.readdir)(this.cacheDir)).filter(e=>e.endsWith(d));if(e.length<=this.maxEntries)return;let t=await Promise.all(e.map(async e=>{let t=(0,n.join)(this.cacheDir,e);try{let r=await (0,a.stat)(t);return{file:e,mtime:r.mtime.getTime()}}catch{return{file:e,mtime:0}}}));t.sort((e,t)=>e.mtime-t.mtime);let r=t.slice(0,t.length-this.maxEntries);await Promise.all(r.map(async({file:e})=>{try{await (0,a.unlink)((0,n.join)(this.cacheDir,e))}catch{}}))}catch{}}async invalidate(e){if(!this.enabled)return 0;await this.ensureInitialized();try{let t=(await (0,a.readdir)(this.cacheDir)).filter(e=>e.endsWith(d)),r=e.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,"."),i=RegExp(`^${r}$`),o=0;return await Promise.all(t.map(async e=>{let t=this.getKeyFromPath(e);if(i.test(t))try{await (0,a.unlink)((0,n.join)(this.cacheDir,e)),o++}catch{}})),o}catch{return 0}}async clear(){if(this.enabled){await this.ensureInitialized();try{let e=(await (0,a.readdir)(this.cacheDir)).filter(e=>e.endsWith(d));await Promise.all(e.map(async e=>{try{await (0,a.unlink)((0,n.join)(this.cacheDir,e))}catch{}})),this.hits=0,this.misses=0}catch{}}}async has(e){if(!this.enabled)return!1;await this.ensureInitialized();let t=await this.readEntry(e);return!!t&&t.metadata.expiresAt>=Date.now()}async stats(){if(!this.enabled)return{hits:0,misses:0,size:0,oldestEntry:null,newestEntry:null};await this.ensureInitialized();try{let e=(await (0,a.readdir)(this.cacheDir)).filter(e=>e.endsWith(d)),t=null,r=null;for(let i of e)try{let e=await (0,a.readFile)((0,n.join)(this.cacheDir,i),"utf-8"),o=JSON.parse(e).metadata.createdAt;(null===t||o<t)&&(t=o),(null===r||o>r)&&(r=o)}catch{}return{hits:this.hits,misses:this.misses,size:e.length,oldestEntry:t,newestEntry:r}}catch{return{hits:this.hits,misses:this.misses,size:0,oldestEntry:null,newestEntry:null}}}async cleanup(){if(!this.enabled)return 0;try{await (0,a.access)(this.cacheDir,o.constants.R_OK)}catch{return 0}try{let e=(await (0,a.readdir)(this.cacheDir)).filter(e=>e.endsWith(d)),t=Date.now(),r=0;return await Promise.all(e.map(async e=>{let i=(0,n.join)(this.cacheDir,e);try{let e=await (0,a.readFile)(i,"utf-8");JSON.parse(e).metadata.expiresAt<t&&(await (0,a.unlink)(i),r++)}catch{try{await (0,a.unlink)(i),r++}catch{}}})),r}catch{return 0}}}function c(e){return new u(e)}},7242:(e,t,r)=>{r.d(t,{Ao:()=>v,wL:()=>$,Qe:()=>_,b5:()=>M});var i=r(1857),n=r(8467);function a(e){return 0===e.length?0:e.reduce((e,t)=>e+t,0)/e.length}function o(e){if(0===e.length)return 0;let t=[...e].sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2==0?(t[r-1]+t[r])/2:t[r]}function l(e){if(e.length<=1)return 0;let t=a(e);return Math.sqrt(a(e.map(e=>(e-t)**2)))}function s(e,t=.1){if(0===e.length)return 0;if(e.length<=2)return a(e);if(3===e.length)return[...e].sort((e,t)=>e-t)[1];let r=[...e].sort((e,t)=>e-t),i=Math.floor(r.length*t);0===i&&r.length>=4&&(i=1);let n=Math.min(i,Math.floor((r.length-2)/2));return a(r.slice(n,r.length-n))}function d(e,t=2){if(e.length<=2)return[];let r=a(e),i=l(e);if(0===i)return[];let n=[];for(let a=0;a<e.length;a++)Math.abs((e[a]-r)/i)>t&&n.push(a);return n}function u(e,t,r="gt"){if(0===e.length)return 0;let i=0;for(let n of e){let e=!1;switch(r){case"gt":e=n>t;break;case"gte":e=n>=t;break;case"lt":e=n<t;break;case"lte":e=n<=t}e&&i++}return i/e.length*100}function c(e,t,r){return e<=t?1:e>=r?.3:1-(e-t)/(r-t)*.7}function m(e,t,r){return e<=t?1:e>=r?.3:1-(e-t)/(r-t)*.7}let h={temperature:{highStdDev:1.5,lowStdDev:4},windSpeed:{highRange:10,lowRange:25}};function p(e){let t=new Map;for(let r of e)for(let e of r.hourly){let i=e.timestamp.toISOString(),n=t.get(i)??[];n.push({model:r.model,hourly:e}),t.set(i,n)}return t}function g(e){let t=new Map;for(let r of e)for(let e of r.daily){let i=e.date.toISOString().split("T")[0],n=t.get(i)??[];n.push({model:r.model,daily:e}),t.set(i,n)}return t}function f(e,t){return e.map(t)}function y(e){let t=function(e){if(0===e.length)return{mean:0,median:0,min:0,max:0,stdDev:0,range:0};let t=[...e].sort((e,t)=>e-t),r=t[0],i=t[t.length-1];return{mean:a(e),median:o(e),min:r,max:i,stdDev:l(e),range:i-r}}(e);return{mean:t.mean,median:t.median,min:t.min,max:t.max,stdDev:t.stdDev,range:t.range}}function w(e){let t=[],r=f(e,e=>e.hourly.metrics.temperature),i=f(e,e=>e.hourly.metrics.precipitation),n=f(e,e=>e.hourly.metrics.windSpeed),o=y(r),s=y(i),u=y(n),c=d(r,2),m=d(i,2),h=d(n,2),p=new Set;for(let i of c){let n=e[i];p.add(n.model);let o=a(r),s=l(r);t.push({model:n.model,metric:"temperature",value:r[i],zScore:s>0?(r[i]-o)/s:0,timestamp:n.hourly.timestamp})}for(let r of m){let n=e[r];p.add(n.model);let o=a(i),s=l(i);t.push({model:n.model,metric:"precipitation",value:i[r],zScore:s>0?(i[r]-o)/s:0,timestamp:n.hourly.timestamp})}for(let r of h){let i=e[r];p.add(i.model);let o=a(n),s=l(n);t.push({model:i.model,metric:"windSpeed",value:n[r],zScore:s>0?(n[r]-o)/s:0,timestamp:i.hourly.timestamp})}let g=e.filter(e=>!p.has(e.model)).map(e=>e.model);return{consensus:{agreementScore:e.length>0?g.length/e.length:0,modelsInAgreement:g,outlierModels:Array.from(p),temperatureStats:o,precipitationStats:s,windStats:u},outliers:t}}function S(e){let t=[],r=f(e,e=>e.daily.temperature.max),i=f(e,e=>e.daily.precipitation.total),n=f(e,e=>e.daily.wind.maxSpeed),o=y(r),s=y(i),u=y(n),c=d(r,2),m=d(i,2),h=d(n,2),p=new Set;for(let i of c){let n=e[i];p.add(n.model);let o=a(r),s=l(r);t.push({model:n.model,metric:"temperature",value:r[i],zScore:s>0?(r[i]-o)/s:0,timestamp:n.daily.date})}for(let r of m){let n=e[r];p.add(n.model);let o=a(i),s=l(i);t.push({model:n.model,metric:"precipitation",value:i[r],zScore:s>0?(i[r]-o)/s:0,timestamp:n.daily.date})}for(let r of h){let i=e[r];p.add(i.model);let o=a(n),s=l(n);t.push({model:i.model,metric:"windSpeed",value:n[r],zScore:s>0?(n[r]-o)/s:0,timestamp:i.daily.date})}let g=e.filter(e=>!p.has(e.model)).map(e=>e.model);return{consensus:{agreementScore:e.length>0?g.length/e.length:0,modelsInAgreement:g,outlierModels:Array.from(p),temperatureStats:o,precipitationStats:s,windStats:u},outliers:t}}function v(e){if(0===e.length)throw Error("Cannot aggregate empty forecast array");let t=e[0],r=e.map(e=>e.model),l=p(e),d=g(e),y=[];for(let[,e]of l){if(0===e.length)continue;let{consensus:t}=w(e),r=function(e){let t=f(e,e=>e.hourly.metrics.temperature),r=f(e,e=>e.hourly.metrics.feelsLike),n=f(e,e=>e.hourly.metrics.humidity),l=f(e,e=>e.hourly.metrics.pressure),d=f(e,e=>e.hourly.metrics.windSpeed),c=f(e,e=>e.hourly.metrics.windDirection),m=e.filter(e=>void 0!==e.hourly.metrics.windGust).map(e=>e.hourly.metrics.windGust),h=f(e,e=>e.hourly.metrics.precipitation),p=f(e,e=>e.hourly.metrics.cloudCover),g=f(e,e=>e.hourly.metrics.visibility),y=f(e,e=>e.hourly.metrics.uvIndex),w=f(e,e=>e.hourly.metrics.weatherCode);return{temperature:(0,i.f7)(s(t)),feelsLike:(0,i.f7)(s(r)),humidity:(0,i._4)(Math.round(a(n))),pressure:(0,i.WI)(a(l)),windSpeed:(0,i.l0)(o(d)),windDirection:(0,i.Kv)(Math.round(a(c))),windGust:m.length>0?(0,i.l0)(o(m)):void 0,precipitation:(0,i.AC)(a(h)),precipitationProbability:u(h,.1,"gt"),cloudCover:(0,i.pS)(Math.round(a(p))),visibility:(0,i.WD)(a(g)),uvIndex:(0,i.m4)(Math.round(o(y))),weatherCode:(0,i.$7)(Math.round(o(w)))}}(e),l=f(e,e=>e.hourly.metrics.precipitation),d=function(e,t){let r=c(e.temperatureStats.stdDev,h.temperature.highStdDev,h.temperature.lowStdDev),i=u(t,.1,"gt"),a=m(3.6*e.windStats.range,h.windSpeed.highRange,h.windSpeed.lowRange);return(0,n.mS)(.4*r+.3*(i>=80||i<=20?1:.5)+.3*a)}(t,l),p=f(e,e=>e.hourly.metrics.temperature),g=f(e,e=>e.hourly.metrics.windSpeed);y.push({timestamp:e[0].hourly.timestamp,metrics:r,confidence:d,modelAgreement:t,range:{temperature:{min:Math.min(...p),max:Math.max(...p)},precipitation:{min:Math.min(...l),max:Math.max(...l)},windSpeed:{min:Math.min(...g),max:Math.max(...g)}}})}y.sort((e,t)=>e.timestamp.getTime()-t.timestamp.getTime());let v=[];for(let[,e]of d){if(0===e.length)continue;let{consensus:t}=S(e),r=function(e){let t=e[0].daily,r=f(e,e=>e.daily.temperature.max),n=f(e,e=>e.daily.temperature.min),l=f(e,e=>e.daily.humidity.max),d=f(e,e=>e.daily.humidity.min),c=f(e,e=>e.daily.pressure.max),m=f(e,e=>e.daily.pressure.min),h=f(e,e=>e.daily.precipitation.total),p=f(e,e=>e.daily.precipitation.hours),g=f(e,e=>e.daily.wind.avgSpeed),y=f(e,e=>e.daily.wind.maxSpeed),w=f(e,e=>e.daily.wind.dominantDirection),S=f(e,e=>e.daily.cloudCover.avg),v=f(e,e=>e.daily.cloudCover.max),M=f(e,e=>e.daily.uvIndex.max),x=f(e,e=>e.daily.weatherCode);return{date:t.date,temperature:{min:(0,i.f7)(s(n)),max:(0,i.f7)(s(r))},humidity:{min:(0,i._4)(Math.round(a(d))),max:(0,i._4)(Math.round(a(l)))},pressure:{min:(0,i.WI)(a(m)),max:(0,i.WI)(a(c))},precipitation:{total:(0,i.AC)(a(h)),probability:u(h,.1,"gt"),hours:Math.round(a(p))},wind:{avgSpeed:(0,i.l0)(a(g)),maxSpeed:(0,i.l0)(o(y)),dominantDirection:(0,i.Kv)(Math.round(a(w)))},cloudCover:{avg:(0,i.pS)(Math.round(a(S))),max:(0,i.pS)(Math.round(a(v)))},uvIndex:{max:(0,i.m4)(Math.round(o(M)))},sun:t.sun,weatherCode:(0,i.$7)(Math.round(o(x))),hourly:[]}}(e),l=f(e,e=>e.daily.precipitation.total),d=function(e,t){let r=c(e.temperatureStats.stdDev,h.temperature.highStdDev,h.temperature.lowStdDev),i=u(t,.1,"gt"),a=m(3.6*e.windStats.range,h.windSpeed.highRange,h.windSpeed.lowRange);return(0,n.mS)(.4*r+.3*(i>=80||i<=20?1:.5)+.3*a)}(t,l),p=f(e,e=>e.daily.temperature.max),g=f(e,e=>e.daily.temperature.min);v.push({date:e[0].daily.date,forecast:r,confidence:d,modelAgreement:t,range:{temperatureMax:{min:Math.min(...p),max:Math.max(...p)},temperatureMin:{min:Math.min(...g),max:Math.max(...g)},precipitation:{min:Math.min(...l),max:Math.max(...l)}}})}v.sort((e,t)=>e.date.getTime()-t.date.getTime());let M=function(e){let t=e.length>0?1/e.length:0;return e.map(e=>({model:e,weight:t,reason:"Equal weighting"}))}(r),x=function(e,t){let r=[...e.map(e=>e.confidence.score),...t.map(e=>e.confidence.score)],i=r.length>0?a(r):.5;return(0,n.mS)(i)}(y,v),D=y.length>0?y[0].timestamp:v.length>0?v[0].date:t.validFrom,$=y.length>0?y[y.length-1].timestamp:v.length>0?v[v.length-1].date:t.validTo;return{coordinates:t.coordinates,generatedAt:new Date,validFrom:D,validTo:$,models:r,modelForecasts:e,consensus:{hourly:y,daily:v},modelWeights:M,overallConfidence:x}}function M(e){if(e.length<=2)return[];let t=[];for(let[,r]of p(e)){if(r.length<=2)continue;let{outliers:e}=w(r);t.push(...e)}for(let[,r]of g(e)){if(r.length<=2)continue;let{outliers:e}=S(r);t.push(...e)}return t}let x={temperature:{spreadHigh:1.5,spreadLow:4,unit:"C"},precipitation:{spreadHigh:2,spreadLow:10,unit:"mm"},wind:{spreadHigh:2.78,spreadLow:6.94,unit:"m/s"},humidity:{spreadHigh:10,spreadLow:30,unit:"%"},overall:{spreadHigh:.7,spreadLow:.4,unit:""}},D={spread:.5,agreement:.3,timeHorizon:.2};function $(e,t,r=0){var i,n;let a=e.models.length,o=x[t],l=[],s=1,d=a,u=0;if("overall"===t){if(e.consensus.hourly.length>0){let t=e.consensus.hourly.map(e=>e.confidence.score),r=t.reduce((e,t)=>e+t,0)/t.length;s=r,u=1-r;let i=e.consensus.hourly.map(e=>e.modelAgreement.modelsInAgreement.length);d=Math.round(i.reduce((e,t)=>e+t,0)/i.length)}}else{let r=e.consensus.hourly;if(r.length>0){let e;let n=r[0].modelAgreement;switch(t){case"temperature":e=n.temperatureStats;break;case"precipitation":e=n.precipitationStats;break;case"wind":e=n.windStats;break;case"humidity":e={stdDev:5}}e&&(u=e.stdDev,s=(i=e.stdDev)<=o.spreadHigh?1:i>=o.spreadLow?.3:1-(i-o.spreadHigh)/(o.spreadLow-o.spreadHigh)*.7),d=n.modelsInAgreement.length}}let c=s*D.spread;l.push({name:"spread",weight:D.spread,score:s,contribution:c,detail:`Spread: ${u.toFixed(1)}${o.unit}`});let m=(n=d,0===a?.5:.3+n/a*.7),h=m*D.agreement;l.push({name:"agreement",weight:D.agreement,score:m,contribution:h,detail:`${d}/${a} models agree`});let p=Math.max(.5,1-.05*Math.min(r,10)),g=p*D.timeHorizon;l.push({name:"timeHorizon",weight:D.timeHorizon,score:p,contribution:g,detail:`${r} day${1===r?"":"s"} ahead`});let f=l.reduce((e,t)=>e+t.contribution,0),y=f>=.8?"high":f>=.5?"medium":"low",w=function(e,t,r,i){let n=e===t?`All ${t} models agree`:`${e} of ${t} models agree`,a="overall"===i?"on the forecast":`on ${i} predictions`;return`${"high"===r?"High confidence":"medium"===r?"Moderate confidence":"Low confidence"}: ${n} ${a}`}(d,a,y,t);return{level:y,score:f,factors:l,explanation:w}}function b(e){return 0===e?"sunny":e>=1&&e<=2?"partly_cloudy":3===e?"cloudy":e>=45&&e<=48?"fog":e>=51&&e<=57?"drizzle":e>=61&&e<=65?"rain":e>=66&&e<=67?"sleet":e>=80&&e<=82?"rain":65===e||82===e?"heavy_rain":e>=71&&e<=77||e>=85&&e<=86?"snow":e>=95&&e<=99?"thunderstorm":"unknown"}function z(e){switch(e){case"sunny":return"sunny";case"partly_cloudy":return"partly cloudy";case"cloudy":return"cloudy";case"overcast":return"overcast";case"fog":return"foggy";case"drizzle":return"light rain";case"rain":return"rain";case"heavy_rain":return"heavy rain";case"thunderstorm":return"thunderstorms";case"snow":return"snow";case"sleet":return"sleet";case"unknown":return"mixed conditions"}}function E(e){return["drizzle","rain","heavy_rain","thunderstorm","snow","sleet"].includes(e)}function k(e){return["sunny","partly_cloudy","cloudy","overcast","fog"].includes(e)}function C(e){switch(e){case"ecmwf":return"ECMWF";case"gfs":return"GFS";case"icon":return"ICON";case"meteofrance":return"ARPEGE";case"ukmo":return"UK Met Office";case"jma":return"JMA";case"gem":return"GEM"}}function T(e){if(0===e.length)return"";if(1===e.length)return C(e[0]);if(2===e.length)return`${C(e[0])} and ${C(e[1])}`;let t=e.map(C),r=t.pop();return`${t.join(", ")}, and ${r}`}function A(e){return`${Math.round(e)}\u00B0C`}function I(e){return e<1?"trace amounts":`${e.toFixed(0)}mm`}function F(e,t=new Date){let r=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=Math.round((r.getTime()-i.getTime())/864e5);return 0===n?"today":1===n?"tomorrow":n>=2&&n<=6?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]:e.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}let O={strong:["Models agree on {condition} conditions through {endDay}.","All models are in agreement: {condition} through {endDay}.","Strong model consensus shows {condition} conditions through {endDay}."]},j={dryToWet:["{condition} arriving {day} {period}.","Expect {condition} to move in {day} {period}.","{condition} expected {day} {period}."],wetToDry:["{condition} clearing by {day}.","Drier conditions returning {day}.","Expect clearing skies by {day}."]},H={high:"Confidence is HIGH for {period}.",medium:"Confidence is MEDIUM for {period}.",low:"Confidence is LOW for {period} - significant model disagreement."};function L(e,t){let r=e;for(let[e,i]of Object.entries(t))r=r.replace(RegExp(`\\{${e}\\}`,"g"),i);return r}function P(e){if(e.consensus.daily.length<2)return null;let t=k(b(e.consensus.daily[0].forecast.weatherCode));for(let r=1;r<e.consensus.daily.length;r++){let i=b(e.consensus.daily[r].forecast.weatherCode);if(t!==k(i))return{day:e.consensus.daily[r],condition:i,period:"afternoon"}}return null}function W(e,t){let r=z(t),i=e.consensus.daily.length>0?F(e.consensus.daily[e.consensus.daily.length-1].date):"the forecast period";return L(O.strong[0],{condition:r,endDay:i})}function _(e,t){let r;if(0===e.consensus.daily.length)return{headline:"No forecast data available.",body:"",alerts:[],modelNotes:[]};let i=function(e,t){if((t.length>0?t.reduce((e,t)=>e+t.score,0)/t.length:.5)<.5)return"disagreement";if(e.consensus.daily.length>=2){let t=b(e.consensus.daily[0].forecast.weatherCode),r=b(e.consensus.daily[e.consensus.daily.length-1].forecast.weatherCode);if(k(t)!==k(r))return"transition"}return"agreement"}(e,t),n=function(e){if(0===e.consensus.daily.length)return"unknown";let t=new Map;for(let r of e.consensus.daily){let e=b(r.forecast.weatherCode);t.set(e,(t.get(e)??0)+1)}let r="unknown",i=0;for(let[e,n]of t)n>i&&(i=n,r=e);return r}(e),a=P(e);switch(i){case"agreement":r=W(e,n);break;case"disagreement":r=function(e,t){let r=e.consensus.daily[0];return r?r.range.temperatureMax.max-r.range.temperatureMax.min>5?"Models disagree significantly on temperatures this period.":r.range.precipitation.max-r.range.precipitation.min>10?"Precipitation amounts uncertain - models show different scenarios.":"Model disagreement creates forecast uncertainty.":"Models show significant uncertainty in the forecast."}(e,0);break;case"transition":r=a?function(e,t){let r=k(b(e.consensus.daily[0].forecast.weatherCode)),i=z(t.condition),n=F(t.day.date);return r&&E(t.condition)?L(j.dryToWet[0],{condition:i.charAt(0).toUpperCase()+i.slice(1),day:n,period:t.period}):L(j.wetToDry[0],{condition:i,day:n})}(e,a):W(e,n)}return{headline:r,body:function(e,t,r){let i=[];if("disagreement"===r){let t=e.consensus.daily[0];if(t){let r=t.modelAgreement.temperatureStats;if(r.range>5){let n=t.modelAgreement.outlierModels.filter(i=>{let n=e.modelForecasts.find(e=>e.model===i),a=n?.daily.find(e=>e.date.toISOString().split("T")[0]===t.date.toISOString().split("T")[0]);return a&&a.temperature.max>r.mean}),a=t.modelAgreement.outlierModels.filter(e=>!n.includes(e));n.length>0&&a.length>0&&i.push(`${T(n)} ${1===n.length?"predicts":"predict"} ${A(t.range.temperatureMax.max)} while ${T(a)} ${1===a.length?"shows":"show"} only ${A(t.range.temperatureMax.min)}.`)}}}else if("transition"===r){let t=P(e);if(t&&E(t.condition)){let r=t.day.date.toISOString().split("T")[0],n=[];for(let t of e.modelForecasts){let e=t.daily.find(e=>e.date.toISOString().split("T")[0]===r);e&&n.push({model:t.model,amount:e.precipitation.total})}if(n.length>=2){let e=[...n].sort((e,t)=>t.amount-e.amount),t=e[0],r=e[e.length-1];t.amount-r.amount>5&&i.push(`${C(t.model)} and ${C(e[1]?.model??r.model)} show heavier rain (${I(t.amount)}) while ${C(r.model)} predicts a lighter system (${I(r.amount)}).`)}}}if(t.length>0){let e=function(e){if(0===e.length)return"medium";let t=e.reduce((e,t)=>e+t.score,0)/e.length;return t>=.8?"high":t>=.5?"medium":"low"}(t);i.push(L(H[e],{period:"transition"===r?"the dry period":"this forecast period"}))}return i.join(" ")}(e,t,i),alerts:function(e,t){let r=[];if(e.consensus.daily.length>0){let t=e.consensus.daily[e.consensus.daily.length-1],i=new Date;if(Math.round((t.date.getTime()-i.getTime())/864e5)>=5){let e=F(new Date(i.getTime()+1728e5));r.push(L("This uncertainty is common at {days}+ days out. Check back {checkDay} for a clearer picture.",{days:String(5),checkDay:e}))}}return(t.length>0?t.reduce((e,t)=>e+t.score,0)/t.length:.5)<.5&&r.push("Significant model disagreement - consider multiple scenarios."),r}(e,t),modelNotes:function(e){let t=[],r=function(e){let t=[];for(let r of e.consensus.daily){let i=r.modelAgreement;for(let n of i.outlierModels){let a=e.modelForecasts.find(e=>e.model===n);if(a){let e=a.daily.find(e=>e.date.toISOString().split("T")[0]===r.date.toISOString().split("T")[0]);if(e){let r=Math.abs(e.temperature.max-i.temperatureStats.mean),a=i.temperatureStats.stdDev>0?r/i.temperatureStats.stdDev:0;a>2&&t.push({model:n,metric:"temperature",value:e.temperature.max,zScore:a});let o=Math.abs(e.precipitation.total-i.precipitationStats.mean),l=i.precipitationStats.stdDev>0?o/i.precipitationStats.stdDev:0;l>2&&t.push({model:n,metric:"precipitation",value:e.precipitation.total,zScore:l})}}}}return t}(e),i=new Map;for(let e of r){let t=i.get(e.model)??[];t.push(e),i.set(e.model,t)}for(let[e,r]of i){if(0===r.length)continue;let i=r.find(e=>"temperature"===e.metric),n=r.find(e=>"precipitation"===e.metric);if(i&&Math.abs(i.zScore)>2){let r=i.zScore>0?"warmer":"cooler";t.push(`${C(e)} is notably ${r} at ${A(i.value)}.`)}if(n&&Math.abs(n.zScore)>2){let r=n.zScore>0?"wetter":"drier";t.push(`${C(e)} shows a ${r} scenario (${I(n.value)}).`)}}return t}(e)}}},180:(e,t,r)=>{r.d(t,{DC:()=>i.DC,a4:()=>n.a4});var i=r(3489),n=r(8467)}};